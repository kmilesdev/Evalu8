You are acting as a Senior Backend Architect reviewing the Evalu8 SaaS backend that uses Drizzle ORM for database schema management.

Replit previously told me that I do not need to write SQL because Drizzle ORM defines the database structure in shared/schema.ts.

I need you to verify and finalize that this setup is production-safe.

STEP 1 — DATABASE CONNECTION VERIFICATION

Identify:

What PostgreSQL provider Evalu8 is using (Replit Postgres, Neon, Supabase Postgres, etc.)

Where DATABASE_URL is defined and how it is being used in the server code

Confirm:

The app is connected to a persistent Postgres database (not in-memory or temporary)

If it is not persistent:

Fix the configuration to use persistent storage

STEP 2 — DRIZZLE MIGRATION SYSTEM

Explain:

How tables in shared/schema.ts are actually created in the database

Confirm:

Are drizzle migrations being used?

Is drizzle-kit configured?

Is there a script such as:
npm run db:push
npm run db:migrate

If migrations are not currently being run automatically:

Create a migration setup

Add the required scripts to package.json

Show the exact shell command I must run in Replit to apply the schema to the database

STEP 3 — SCHEMA AUDIT

Verify the existence of the following tables:

profiles

jobs

applications

messages

evaluations

flags

Confirm the jobs table includes default values:
simulation_type = 'problem_solving'
seniority_level = 'mid'
num_questions = 8
time_limit_minutes = 15

Confirm job_token:

is generated automatically

is unique

is indexed

STEP 4 — DATA PERSISTENCE TEST

Provide steps to:

Create a job as a recruiter

Create a candidate application

Submit an interview

Restart the repl

Confirm that all data still exists

If data would be lost on restart:

Fix the storage so all recruiter and candidate data persists

STEP 5 — SERVER HEALTH CHECK

Add a backend route:

GET /api/health

This should:

Check the database connection using a simple SELECT 1 query

Return:

{
"ok": true,
"db": "connected"
}

STEP 6 — SECURITY ENFORCEMENT

Because we are not using Supabase RLS, enforce authorization at the Express backend level.

Ensure:

Recruiter routes:

Require authentication middleware

Only return jobs where owner_id matches logged-in user

Only return applications belonging to recruiter-owned jobs

Candidate public routes:

Validate job_token exists

Allow creation of applications only for valid jobs

Prevent reading of recruiter dashboards or other applications

If any recruiter can currently see another recruiter’s job or candidate:

Fix immediately using backend middleware

STEP 7 — ENVIRONMENT VARIABLES

List the exact environment variables I must configure in Replit Secrets, including:

DATABASE_URL
OPENAI_API_KEY
JWT_SECRET or session secret if used

FINAL OUTPUT

Provide:

Database provider confirmation

Migration command(s) to run

Health check route added

Security middleware verified or added

Persistence test instructions

Final checklist that Evalu8 backend is production-safe

Perform this audit now.